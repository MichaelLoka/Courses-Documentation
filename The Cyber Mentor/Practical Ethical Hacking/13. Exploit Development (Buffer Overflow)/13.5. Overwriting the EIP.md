Overriding the EIP (Extended Instruction Pointer) is a critical step to achieve code execution control within the vulnerable application. The EIP is a register in the x86 architecture (and other similar architectures) that points to the next instruction to be executed by the processor. By corrupting the EIP, an attacker can redirect the program's flow to execute their malicious code instead of the intended instructions, leading to arbitrary code execution.

1. **Identifying the Vulnerability**: The attacker first identifies a buffer overflow vulnerability in the target application. This vulnerability occurs when the application does not properly validate or sanitize user input before copying it into a fixed-size buffer, leading to a buffer overflow.
2. **Controlling the EIP**: The attacker crafts a carefully constructed payload, which includes both data to overflow the buffer and the address of their malicious code. The attacker aims to overwrite the EIP with the address of their payload.
3. **Payload Placement**: The payload is placed in a location that the attacker can control, such as an input field or command-line argument, which will be copied into the vulnerable buffer.
4. **Exploitation**: When the vulnerable application copies the attacker's payload into the buffer, it overflows the buffer, and as a result, the EIP is overwritten with the address specified in the payload.
5. **Redirecting Execution**: Since the EIP now points to the address specified by the attacker, when the function returns or the program executes a "ret" (return) instruction, it jumps to the address provided by the attacker instead of the original function's return address. This allows the attacker to divert the program's execution flow to their malicious code.
6. **Payload Execution**: The malicious code placed by the attacker is then executed, granting them control over the compromised system. This can lead to various outcomes, such as running a shellcode to gain remote access or carrying out other unauthorized actions.

#### Fuzzing to Control the EIP
```python
#!/usr/bin/python 
import sys, socket

shellcode = "A" * <EIP Offset> + "B" * 4

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
	s.connect(('192.168.1.35',9999)) 
	
	s.send(('TRUN /.:/' + shellcode)) 
	s.close()
except:
	print ("Error Connecting to Server") 
	sys.exit()
```

![[Returning To Offset Address (Controlling EIP).png]]
