### Overview
Network pivoting, also known as lateral movement or pivot attacks, is a technique used by cyber attackers to expand their control and access within a target network. The primary objective of network pivoting is to move from one compromised system (usually an initial foothold) to other systems or segments of the network, gradually increasing the attacker's influence and potential damage.

#### Feature
1. **Initial Compromise**: The attacker gains access to one or more systems within the target network through various means, such as exploiting vulnerabilities, using social engineering techniques, or deploying malware.
2. **Exploiting Trust Relationships**: Once inside the initial compromised system, the attacker looks for trust relationships between systems. These relationships could be in the form of shared credentials, trust between machines in the same network segment, or other insecure configurations.
3. **Moving Laterally**: Using the trust relationships or vulnerabilities found, the attacker attempts to gain unauthorized access to other systems within the network. This might involve exploiting known vulnerabilities, using stolen credentials, or employing privilege escalation techniques.
4. **Persistence and Control**: As the attacker gains access to additional systems, they work to maintain persistence, ensuring continued access even if the initial point of entry is discovered and mitigated.
5. **Escalating Privileges**: Throughout the lateral movement process, the attacker may escalate privileges on compromised systems to gain higher levels of access and control over critical resources.
6. **Further Pivoting**: The process of lateral movement and privilege escalation can continue until the attacker reaches their ultimate target, which might be a sensitive database, critical server, or other valuable assets.

#### Mitigation
- **Network Segmentation**: Properly segmenting the network can limit an attacker's ability to move laterally. If systems are isolated from each other, compromising one system won't automatically give access to others.
- **Least Privilege**: Enforce the principle of least privilege to limit the permissions granted to users and systems. This can reduce the impact of privilege escalation attempts.
- **Regular Patching and Updates**: Keeping all systems and software up-to-date with the latest security patches can prevent attackers from exploiting known vulnerabilities.
- **Monitoring and Intrusion Detection**: Implementing robust monitoring and intrusion detection systems can help identify unusual network behavior and pivot attempts.
- **Strong Authentication**: Enforce strong password policies and consider multi-factor authentication to make it harder for attackers to use stolen credentials.
- **Education and Training**: Regularly train employees on cybersecurity best practices to reduce the risk of social engineering attacks and improve overall security awareness.

### Proxy Chains
Proxychains is a powerful command-line tool used for routing TCP and DNS connections through multiple proxy servers. It allows users to chain multiple proxies together, which can help in enhancing anonymity, bypassing network restrictions, and conducting certain security-related tasks, such as penetration testing and vulnerability assessments.

#### Usage
**1. Installation:** Proxychains is available for Unix-based systems, such as Linux and macOS. To install it, follow these steps:
```bash
sudo apt update sudo apt install proxychains
```
**2. Configuration:** Once installed, you need to configure Proxychains by editing its configuration file. The configuration file is usually located at `/etc/proxychains.conf`.
```bash
sudo nano /etc/proxychains.conf
```
**3. Configure Proxy Servers:** In the configuration file, you'll find a list of proxy types (e.g., HTTP, SOCKS4, SOCKS5) and sample proxy entries. You can modify or add proxy servers as needed. The most common configuration for SOCKS5 proxies is as follows:
```bash
# Format: <proxy_type> <proxy_ip> <proxy_port> socks5  127.0.0.1 1080
```
You can replace `127.0.0.1` with the IP address of the proxy server, and `1080` with the corresponding port number. If you have multiple proxies, you can add more entries with different IP addresses and ports.
**4. Using Proxychains:** After configuring the proxies, you can use Proxychains to run applications with traffic routed through the specified proxies. The basic syntax to use Proxychains is:
```bash
proxychains <command>
proxychains firefox
`proxychains curl http://example.com`
```
**5. Testing Proxychains:** To ensure Proxychains is working correctly, you can use tools like `curl` or `wget` to fetch your public IP address or access a website that displays your IP address. Running these commands with Proxychains should show the IP address of the last proxy server in the chain, confirming that the traffic is being routed through the proxies.
```bash
proxychains curl ifconfig.me
proxychains wget -qO- ifconfig.me
```

#### Example Scripts
```bash
# Identify the Proxy Port (9050)
$ cat /etc/proxychains4.conf

$ ssh -f -N -D 9050 -i pivot root@10.10.10.5
$ proxychains nmap -p88 10.10.10.5 -sT
$ proxychains GetUserSPNs.py Marvel.lcoal/fcastle:Password1 -dc -ip 10.101.10.225 -request
$ proxychains xfreedp /u:administrator /p:'Hacker321!' /v:10.10.10.255
$ proxychains firefox
```
##### Explanation
1. **SSH Tunneling:** `$ ssh -f -N -D 9050 -i pivot root@10.10.10.5`
	- This command establishes an SSH connection to the server at IP address 10.10.10.5 as the `root` user, using the private key file `pivot` (`-i` flag). The `-f` option runs SSH in the background, and `-N` tells SSH not to execute any remote commands after connecting. The `-D` flag sets up a local SOCKS proxy on port 9050, which can be used for proxying network traffic.
2. **Network Scanning with Nmap:** `$ proxychains nmap -p88 10.10.10.5 -sT`
	- This command performs a TCP SYN port scan (`-sT`) using Nmap through the Proxychains tool. Nmap will scan the target IP address 10.10.10.5 for port 88 (`-p88`). Proxychains will route Nmap's traffic through the local SOCKS proxy created in the previous step, providing some level of anonymity for the scan.
3. **Active Directory Enumeration with GetUserSPNs.py:** `$ proxychains GetUserSPNs.py Marvel.local/fcastle:Password1 -dc -ip 10.101.10.225 -request`
	- This command uses the Python script `GetUserSPNs.py` for enumerating Service Principal Names (SPNs) in an Active Directory environment. The script is targeting the domain controller (`-dc`) with IP address 10.101.10.225 (`-ip 10.101.10.225`) and authenticating with the user `fcastle` and the password `Password1` in the domain `Marvel.local`. Proxychains routes the script's network traffic through the SOCKS proxy, enhancing privacy.
4. **Remote Desktop Session:** `$ proxychains xfreerdp /u:administrator /p:'Hacker321!' /v:10.10.10.255`
	- This command launches a remote desktop session using `xfreerdp`, which is a remote desktop client for RDP (Remote Desktop Protocol) connections. It connects to the target IP address 10.10.10.255 with the provided username (`/u:administrator`) and password (`/p:'Hacker321!'`). The entire RDP traffic is routed through Proxychains for anonymity.
5. **Launching Firefox:** `$ proxychains firefox`
	- This command opens the Firefox web browser through Proxychains. Firefox will use the local SOCKS proxy created earlier to route its network traffic, allowing for anonymous web browsing.

### SShuttle
sshuttle is a popular Python-based VPN-like tool that allows you to create a secure, encrypted, and flexible VPN-like connection over SSH. It can be used for tunneling traffic, forwarding specific ports, and bypassing network restrictions. Here's a brief overview of its features and some examples of how to use it:

#### Features
1. **Full Traffic VPN:**
    - sshuttle creates a full VPN (Virtual Private Network) by tunneling all your network traffic through an SSH connection, providing secure and encrypted communication.
2. **Subnet Routing:**
    - It allows you to specify a subnet or target multiple subnets that should be routed through the SSH connection, offering more flexibility than traditional SSH tunneling.
3. **DNS Traffic Forwarding:**
    - sshuttle can also forward DNS traffic through the SSH connection, ensuring that DNS queries are also securely routed.
4. **Transparent Proxying:**
    - With the `--transparent` option, sshuttle can act as a transparent proxy, capturing all traffic to specific target IP addresses or subnets and routing it through the SSH tunnel.
5. **Compression and Performance:**
    - It employs compression to improve performance, especially over slow or high-latency connections.

#### Usage
1. **Basic Usage:** To create a basic VPN-like connection to a remote server using sshuttle, use the following command:
	```bash
	sshuttle -r user@remote_server 0/0
	```
	- This will tunnel all your network traffic through the SSH connection to the remote server. 
2. **Specific Subnet Routing:** To route specific subnets through the SSH connection, you can specify the target subnets as follows:
	```bash
	sshuttle -r user@remote_server 192.168.1.0/24 10.0.0.0/16
	```
	- This example routes traffic for the `192.168.1.0/24` and `10.0.0.0/16` subnets through the SSH connection.
3. **DNS Traffic Forwarding:** To forward DNS queries through the SSH tunnel, use the `--dns` option:
	```bash
	sshuttle --dns -r user@remote_server 0/0
	```
	- This ensures that DNS queries are securely forwarded through the SSH connection. 
4. **Transparent Proxying:** To use sshuttle as a transparent proxy, capture traffic to specific target IP addresses and route it through the SSH tunnel:
	```bash
	sshuttle --dns -r user@remote_server 192.168.1.100,192.168.1.200
	```
	- In this example, all traffic to IP addresses `192.168.1.100` and `192.168.1.200` will be routed through the SSH connection.

#### Example Script
```bash
sshuttle -r root@10.10.10.5 --ssh-cmd "ssh -i pivot"
```
##### Explanation
- `sshuttle`: This is the command for the `sshuttle` tool.
- `-r root@10.10.10.5`: The `-r` option specifies the remote server to which you want to establish the SSH connection. In this case, it connects to the server with IP address `10.10.10.5`, and the SSH connection is made using the `root` user account. The format is `username@remote_server`.
- `--ssh-cmd "ssh -i pivot"`: The `--ssh-cmd` option allows you to specify a custom SSH command that sshuttle will use to establish the SSH connection. In this case, the custom SSH command is `"ssh -i pivot"`.
- `"ssh -i pivot"`: This is the custom SSH command that sshuttle will use. It specifies how to execute SSH and includes the `-i` flag, which is used to specify the private key (`pivot`) to use for authentication.
